# 科研论文专用图片组合工具

一个专为科研人员设计的图片组合工具，用于论文中多幅子图的拼接、排版和标准化，适配SCI/核心期刊的图片投稿要求。

## 功能特点

### 基础排版功能
- ✅ 支持单张/批量导入图片（PNG/JPG/TIFF/EPS格式）
- ✅ 可视化选择行列布局，实时预览布局效果
- ✅ 支持自由拖拽调整子图顺序
- ✅ 统一子图尺寸：等比例缩放、居中裁剪，支持多种分辨率（150/300/600 DPI）

### 精细化排版配置
- ✅ 间距自定义：支持像素/厘米双单位
- ✅ 子图标签定制：三种格式（(a)(b)(c)、a/b/c、Fig1a/Fig1b），可自定义位置、字体、字号、颜色
- ✅ 画布配置：背景色（白色/透明/黑色）、画布边距
- ✅ 比例锁定：强制子图固定宽高比（1:1、4:3、16:9）
- ✅ 多图对齐：水平居中/左对齐/右对齐

### 输出与批量处理
- ✅ 高清输出：支持PNG/TIFF/PDF/EPS格式，矢量格式优先适配期刊要求
- ✅ 批量拼接：支持导入多个文件夹，按文件夹批量生成组合图
- ✅ 配置保存：支持保存和加载排版配置，避免重复设置

### 界面特点
- ✅ 五区布局：图片导入区+布局设置区+精细化配置区+预览区+输出区
- ✅ 实时预览：所有参数修改后自动刷新预览
- ✅ 操作便捷：一键导入、一键拼接、保存配置、加载配置、一键输出
- ✅ 状态提示：状态栏显示当前操作状态和错误信息

## 环境要求

- Python 3.8 或更高版本
- Windows / macOS / Linux

## 安装步骤

### 1. 克隆或下载项目

```bash
git clone <repository-url>
cd photoDealTool
```

### 2. 安装依赖

```bash
pip install -r requirements.txt
```

### 3. 运行程序

```bash
python main.py
```

## 使用说明

### 基础操作流程

#### 1. 导入图片
- 点击"导入图片"按钮，选择一张或多张图片
- 或直接将图片拖拽到图片列表区域
- 支持的格式：PNG、JPG、JPEG、TIFF、TIF、EPS

#### 2. 设置布局
- **行数/列数**：设置子图的行列布局
- **缩放模式**：
  - 最长边：按最长边缩放
  - 最短边：按最短边缩放
  - 自定义尺寸：按指定尺寸缩放
  - 居中裁剪：居中裁剪到指定尺寸
- **图片尺寸**：设置缩放后的尺寸（像素）
- **宽高比**：选择固定宽高比或自由比例

#### 3. 精细化配置
- **间距设置**：
  - 水平间距/垂直间距：设置子图之间的间距
  - 单位：像素或厘米
- **子图标签**：
  - 标签格式：(a)(b)(c)、a/b/c、Fig1a/Fig1b
  - 标签位置：左上角、右上角
  - 字体：Arial、宋体、黑体、Times New Roman
  - 字号：8-72号
  - 颜色：黑色、白色
  - 标签边距：标签与子图边缘的间距
- **画布设置**：
  - 背景色：白色、透明、黑色
  - 画布边距：整体组合图的外边框
- **对齐方式**：居中、左对齐、右对齐

#### 4. 预览和输出
- 预览区会实时显示组合图效果
- 点击"刷新预览"按钮手动更新预览
- 点击"输出图片"按钮保存组合图
- 选择输出格式（PNG/TIFF/PDF/EPS）和分辨率（150/300/600 DPI）

#### 5. 配置管理
- 点击"保存配置"按钮，将当前排版参数保存为JSON文件
- 点击"加载配置"按钮，加载之前保存的配置

### 批量处理功能

#### 使用批量处理
1. 设置好排版参数（行列、间距、标签等）
2. 点击"批量处理"按钮
3. 选择包含图片的文件夹（可以是包含多个子文件夹的父文件夹）
4. 选择输出目录
5. 等待处理完成，查看处理结果

#### 批量处理规则
- 每个文件夹中的图片会被组合成一个组合图
- 组合图以文件夹名称命名
- 所有文件夹使用相同的排版配置
- 处理过程中可以取消操作

### 高级技巧

#### 拖拽调整顺序
- 在图片列表中拖拽图片可以调整子图顺序
- 预览会自动更新

#### 期刊投稿建议
- 推荐使用300 DPI分辨率
- 矢量格式（PDF/EPS）优先，适合期刊投稿
- 使用白色背景，避免透明背景导致的问题
- 标签使用Times New Roman字体，字号12-14

#### 大图片处理
- 对于大尺寸图片，建议先使用"居中裁剪"模式
- 批量处理时，建议分批处理，避免内存不足

## 常见问题

### Q1: 导入EPS图片失败怎么办？
A: 确保安装了matplotlib库，程序使用matplotlib加载EPS格式。

### Q2: 预览显示不清晰？
A: 预览是缩略图，实际输出时使用设置的DPI，输出图片会非常清晰。

### Q3: 批量处理时程序卡死？
A: 批量处理在后台线程运行，请耐心等待。如果长时间无响应，可以取消操作。

### Q4: 输出的PDF/EPS文件无法编辑？
A: 确保使用矢量格式输出，并且源图片是矢量格式（如EPS）。

### Q5: 如何修改默认配置？
A: 编辑`config.py`文件中的`DEFAULT_CONFIG`字典。

### Q6: 程序启动报错？
A: 检查Python版本是否为3.8+，并确保所有依赖已正确安装。

## 打包教程

### Windows打包为.exe文件

#### 1. 安装PyInstaller
```bash
pip install pyinstaller
```

#### 2. 创建打包脚本
在项目根目录创建`build_exe.bat`文件：

```batch
@echo off
echo 正在打包科研论文图片组合工具...

pyinstaller --name="科研论文图片组合工具" ^
--icon=icon.ico ^
--onefile ^
--windowed ^
--add-data "requirements.txt;." ^
main.py

echo 打包完成！
pause
```

#### 3. 运行打包脚本
双击`build_exe.bat`，等待打包完成

#### 4. 查看输出
打包完成后，在`dist`目录下会生成`科研论文图片组合工具.exe`文件

#### 5. 分发
将`.exe`文件直接复制到其他Windows电脑即可运行，无需安装Python环境

### macOS打包为.app文件

#### 1. 安装PyInstaller
```bash
pip install pyinstaller
```

#### 2. 创建打包脚本
在项目根目录创建`build_app.sh`文件：

```bash
#!/bin/bash
echo "正在打包科研论文图片组合工具..."

pyinstaller --name="科研论文图片组合工具" \
--icon=icon.icns \
--onefile \
--windowed \
--add-data "requirements.txt:." \
main.py

echo "打包完成！"
```

#### 3. 运行打包脚本
```bash
chmod +x build_app.sh
./build_app.sh
```

#### 4. 查看输出
打包完成后，在`dist`目录下会生成可执行文件

### Linux打包

#### 1. 安装PyInstaller
```bash
pip install pyinstaller
```

#### 2. 打包命令
```bash
pyinstaller --name="科研论文图片组合工具" \
--onefile \
--windowed \
--add-data "requirements.txt:." \
main.py
```

### 打包注意事项

1. **图标文件**：准备`.ico`（Windows）或`.icns`（macOS）格式的图标文件
2. **依赖文件**：使用`--add-data`参数添加必要的配置文件
3. **测试**：打包后在干净环境中测试可执行文件
4. **文件大小**：`--onefile`模式会生成较大的文件，但分发方便
5. **权限**：macOS可能需要授予可执行文件权限

## 项目结构

```
photoDealTool/
├── main.py              # 程序入口
├── image_process.py     # 图像处理模块
├── config.py           # 配置管理模块
├── batch_process.py    # 批量处理模块
├── gui.py              # GUI界面模块
├── requirements.txt    # 依赖文件
└── README.md          # 使用说明
```

## 技术栈

- **图像处理**：Pillow + numpy
- **GUI框架**：PyQt5
- **配置管理**：JSON
- **打包工具**：PyInstaller

## 版本历史

### v1.0.0 (2024-01-01)
- 初始版本发布
- 实现基础排版功能
- 实现精细化配置
- 实现批量处理
- 支持多种输出格式

## 许可证

本项目仅供学术研究使用。

## 联系方式

如有问题或建议，欢迎提交Issue或Pull Request。

## 致谢

感谢所有为本项目做出贡献的开发者。